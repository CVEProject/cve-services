# CVE-API

[![Gitter](https://badges.gitter.im/cve-awg/community.svg)](https://gitter.im/cve-awg/community?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)

## Table of contents

* [Technologies](#technologies)
* [Style Guidelines](#style-guidelines)
* [Directory Layout](#directory-layout)
* [Setup](#setup)
* [API Documentation](#api-documentation)
* [Unit Testing](#unit-testing)

## Technologies

This project uses or depends on software from

- NodeJS https://nodejs.org/
- Express https://github.com/expressjs
- MongoDB
- PM2 http://pm2.keymetrics.io/
- Mongoose.js https://mongoosejs.com

## Style Guidelines

This project uses the following Style Guidelines

- https://github.com/standard/standard

## Directory layout

### Top Level Directory

    .
    ├── src                     # Source files (This is where the API resides)
    ├── test                    # Automated tests (This is where the API tests reside)
    ├── LICENSE
    └── README.md               

### Src Directory

    .
    ├── ...
    ├── src                     # Source files (This is where the API resides)
    │   ├── controller/         # All API logic resides here.
    │   ├── model/              # All Mongoose Schemas, models, and database logic.
    │   ├── middleware/         # Authentication middleware resides inside this folder. 
    │   ├── routes.config.js    # This is where routes get created and get tied back to their specific controller. 
    │   └── index.js            # Where everything begins.
    └── ...

## Setup

### Step 1. Install required node modules

This assumes the latest `node` and `npm` are installed.

```sh
cd cve-services
npm install
```

### Step 2. Setup and start MongoDB locally

Install MongoDB locally

- https://docs.mongodb.com/manual/administration/install-community/

Download MongoDB Compass (MongoDB GUI)

- https://www.mongodb.com/download-center/compass

Create a `cve_dev` and `cve_test` database. The collections will be autmatically created when the API starts storing documents.

### Step 3. Start the node application

In order to start a dev enviorment:

```sh
npm run start:dev
```

<!--
## Api Documentation

ApiDoc: http://apidocjs.com/

In order to create API docs run:

```sh
    npm run docs
```

This creates an html file that can be found under apidocs/
-->

## Unit Testing

This project uses the following for unit testing

- https://mochajs.org/
- https://www.chaijs.com/

Before running the unit tests, change the ```NODE_ENV``` variable in the ```.env``` file from ```dev``` to ```test```. 
Note: The application must be running in order to run the unit tests. 

Use the following command in a new terminal to run the unit tests:

```sh
npm run start:test
```
<!--
## In order to view server logs and to stop server

To view logs:

```sh
pm2 logs
```

To stop the server

```sh
pm2 stop all
```
-->
