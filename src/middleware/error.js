const idrErr = require('../utils/error')
class MiddlewareError extends idrErr.IDRError {
  badRequest (header) { // mw
    const err = {}
    err.error = 'BAD_REQUEST'
    err.message = `${header} header field required.`
    return err
  }

  unauthorized () { // mw
    const err = {}
    err.error = 'UNAUTHORIZED'
    err.message = 'Unauthorized'
    return err
  }

  secretariatOnly () { // mw
    const err = {}
    err.error = 'SECRETARIAT_ONLY'
    err.message = 'This function is currently only allowed to the Secretariat. This will change for many functions as more administrative roles are implemented.'
    return err
  }

  cnaOnly () { // mw
    const err = {}
    err.error = 'CNA_ONLY'
    err.message = 'This function is currently only allowed to CNAs. This will change for many functions as more administrative roles are implemented.'
    return err
  }

  invalidJsonSchema (errors) { // mw
    const err = {}
    err.error = 'INVALID_JSON_SCHEMA'
    err.message = 'CVE JSON schema validation FAILED.'
    err.details = {
      errors: errors
    }

    return err
  }

  recordTooLarge () {
    const err = {}
    err.error = 'RECORD_TOO_LARGE'
    err.message = 'Records must be less than 16MB.'
    return err
  }
}

module.exports = {
  MiddlewareError
}
