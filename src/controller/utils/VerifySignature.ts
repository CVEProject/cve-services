import * as NodeRSA from 'node-rsa';

/**
 * Verify validation of signature recived from client.
 * @param {string} signature - Signature recived from client.
 * @param {string} publicKey - Publickey stored in DB for the UUID of requesting client.
 * @param {Object} payload - Payload the client is trying to send.
 * @returns {boolean} - If true, user has passed verification.
 */
export function verifySignature(signature, publicKey, payload) {
    if (payload === undefined) {
        payload = '';
    }
    let serverNodeRsa = new NodeRSA(publicKey);
    serverNodeRsa.setOptions({ signingScheme: process.env.RSASigningSchema });
    return serverNodeRsa.verify(payload, signature, null, 'hex');
}
